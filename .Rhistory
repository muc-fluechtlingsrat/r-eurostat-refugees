demo()
datasets <- search_eurostat("asylum", type = "dataset")
load_data_acceptance
devtools::document()
source('~/r-eurostat-refugees/R/eurostat_queries.R')
devtools::document()
load_data_acceptance()
load_data_acceptance
install.packages(magrittr)
install.packages("magrittr")
installed.packages()
install.packages("tidyr")
install.packages("dplyr")
install.packages("magrittr")
install.packages("ggplot2")
install.packages("eurostat")
install.packages("gridExtra")
install.packages("lubridate")
load_data_acceptance()
source('~/r-eurostat-refugees/R/eurostat_queries.R')
load_data_acceptance()
install.packages("tidyr")
install.packages("dplyr")
if(length(new.packages)) install.packages(new.packages)
type(list.of.packages)
listofpackages <- c("tidyr", "dplyr", "magrittr", "ggplot2", "eurostat", "gridExtra", "lubridate")
newpackages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
list.of.packages <- c("tidyr", "dplyr", "magrittr", "ggplot2", "eurostat", "gridExtra", "lubridate")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
typeof(l)
installed.packages()
load_data_acceptance()
library(list.of.packages)
ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
packages <- c("ggplot2", "plyr", "reshape2", "RColorBrewer", "scales", "grid")
list.of.packages <- c("tidyr", "dplyr", "magrittr", "ggplot2", "eurostat", "gridExtra", "lubridate")
ipak(list.of.packages)
load_data_acceptance()
filter_destination_country()
data = readRDS('/Users/suny/r-eurostat-refugees/data_acceptance')
data = readRDS('/Users/suny/r-eurostat-refugees/data/data_acceptance')
size(data)
sizeof(data)
typof(data)
typeof(data)
length(data)
length(data[1])
data
width(data)
dim(data)
data[4000][]
data[][400]
data[4000][
]
data[40]
cleaned_data = cleaned_data()
dim(data)
dim(cleaned_data)
data
load_data_acceptance_from_file('/Users/suny/r-eurostat-refugees/data/data_acceptance')
library(eurostatasyl)
load_data_acceptance_from_file('/Users/suny/r-eurostat-refugees/data/data_acceptance')
data_acc = load_data_acceptance_from_file('/Users/suny/r-eurostat-refugees/data/data_acceptance')
data_acc = load_data_acceptance_from_file('/Users/suny/r-eurostat-refugees/data/data_acceptance')
library(eurostatasyl)
data_acc = load_data_acceptance_from_file('/Users/suny/r-eurostat-refugees/data/data_acceptance')
ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
packages <- c("ggplot2", "plyr", "reshape2", "RColorBrewer", "scales", "grid")
list.of.packages <- c("tidyr", "dplyr", "magrittr", "ggplot2", "eurostat", "gridExtra", "lubridate")
ipak(list.of.packages)
data_acc = load_data_acceptance_from_file('/Users/suny/r-eurostat-refugees/data/data_acceptance')
head(data)
typeof(data)
str(data)
data[[100]]
data[[4]]
data[[4]][40:45]
data[[.]][40:45]
data[[]][40:45]
data[[0:8]][40:45]
data[[0:7]][40:45]
data[[1:7]][40:45]
data[[1:6]][40:45]
data[[c(1,2,3)]][40:45]
data[[7]][40:45]
data[[8]][40:45]
plot_acc_by_c_of_origin(data,2015)
str(data)
label(data)
eurostatasyl.help
eurostatasyl.help()
roxygen2::roxygenise()
library(roxygen2)
install.packages(roxygen2)
install.packages("roxygen2"")
""
install.packages("roxygen2")
library(roxygen2)
roxygen2::roxygenise()
unique(data[[1]])
str(data)
unique(data[[5]])
language = EN
unique(data[[1]])
unique(data[[5]])
str(data)
data_eritrea <- data%>%filter(citizen=="Eritrea")
head(data_eritrea)
View(data_eritrea)
dim(data_eritrea)
ordered_data<-unique(data[[5]])%>%arrange(.)
ordered_data<-order(unique(data[[5]]))
View(ordered_data)
sorted_data<-sort(unique(data[[5]]))
View(sorted_data)
sorted_data
major_countries_dest=c("Belgium","France","Germany (until 1990 former territory of the FRG)","Greece","Italy","Netherlands","Norway","Sweden","Spain","Switzerland","United Kingdom")
decisions=c("Rejected", "Total_positive_decisions", "Total")
data_eritrea <- data%>%filter(citizen=="Eritrea")
data_eritrea_major_decision <- data%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decisions%in%decisions)
View(data_eritrea_major_decision)
data_eritrea_major_decision <- data_eritrea%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decisions%in%decisions)
data_eritrea_major_decision <- data_eritrea%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decision%in%decisions)
data_eritrea_major_decision <- data_eritrea%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decision%in%decisions,age=="Total")
data_eritrea_major_decision <- data_eritrea%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decision%in%decisions,age=="Total",sex=="Total")
hist(data_eritrea_major_decision$time)
hist(data_eritrea_major_decision$time,breaks=3)
hist(data_eritrea_major_decision$time,breaks=30)
data_eritrea_major_decision <- data_eritrea%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decision%in%decisions,age=="Total",sex=="Total",time="2017-01-01")
data_eritrea_major_decision <- data_eritrea%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decision%in%decisions,age=="Total",sex=="Total",time=="2017-01-01")
data_eritrea_major_decision <- data_eritrea%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decision%in%decisions,age=="Total",sex=="Total",substr(time,1,4)=="2017")
data_eritrea_major_decision <- data_eritrea%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decision%in%decisions,age=="Total",sex=="Total",substr(time,1,4)=="2015")
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(time,geo,decision)%>%summarise(sum_dec=sum(values))
data_eritrea_major_decision_sum
ggplot2(data_eritrea_major_decision_sum)
ggplot(data_eritrea_major_decision_sum)
ggplot(data_eritrea_major_decision_sum, aes(value, groups=decision)) + geom_bwplot
ggplot(data_eritrea_major_decision_sum, aes(value, groups=decision)) + geom_boxplot
ggplot(data_eritrea_major_decision_sum, aes(value, groups=decision)) + geom_boxplot<()
ggplot(data_eritrea_major_decision_sum, aes(value, groups=decision)) + geom_boxplot()
ggplot(data_eritrea_major_decision_sum, aes(value, groups=decision)) + geom_bar()
ggplot(data_eritrea_major_decision_sum, aes(values, groups=decision)) + geom_bar()
ggplot(data_eritrea_major_decision, aes(values, groups=decision)) + geom_bar()
ggplot(data_eritrea_major_decision, aes(values)) + geom_bar()
ggplot(data_eritrea_major_decision, aes(values)) + geom_bar() +facet_wrap(~decisions)
ggplot(data_eritrea_major_decision, aes(values)) + geom_bar() +facet_wrap(~decision)
ggplot(data_eritrea_major_decision, aes(values,color=decision)) + geom_bar()
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)%>%summarise(sum_dec=sum(values))
data_eritrea_major_decision_sum
View(data_eritrea_major_decision_sum)
write(data_eritrea_major_decision_sum,file="eritrea_decision_major_eucountries_20170426")
data_eritrea_major_decision_sum.df = ldply(data_eritrea_major_decision_sum, function(t) t$toDataFrame())
library(plyr)
data_eritrea_major_decision_sum.df = ldply(data_eritrea_major_decision_sum, function(t) t$toDataFrame())
data_eritrea_major_decision_sum.df = ldply(data_eritrea_major_decision_sum, function(t) [t]toDataFrame())
typeof(data_eritrea_major_decision_sum)
typeof(data_eritrea_major_decision_sum[[]])
typeof(data_eritrea_major_decision_sum[])
write.csv2(data_eritrea_major_decision_sum,file="eritrea_decision_major_eucountries_20170426")
write.csv2(data_eritrea_major_decision_sum,file="data/eritrea_decision_major_eucountries_20170426.csv")
write.csv2(data_eritrea_major_decision_sum,file="data/eritrea_decision_major_eucountries_20170426.csv",sep=",")
write.csv
write.csv2(data_eritrea_major_decision_sum,file="data/eritrea_decision_major_eucountries_20170426.csv",sep=",",dec = "")
write.table(data_eritrea_major_decision_sum,file="data/eritrea_decision_major_eucountries_20170426.csv",sep=",",dec = "")
write.table(data_eritrea_major_decision_sum,file="data/eritrea_decision_major_eucountries_20170426.csv",sep=",",dec = " ")
str(data_eritrea_major_decision_sum)
data_eritrea_major_decision_rate <- data_eritrea_major_decision_sum %>%
mutate(decision = ifelse(decision == "Total positive decisions",
"Total_positive_decisions",
decision)) %>%
spread(decision, value) %>%
mutate(Rejected = Rejected / Totals
data_eritrea_major_decision_rate <- data_eritrea_major_decision_sum %>% spread(decision, value)
data_eritrea_major_decision_rate <- data_eritrea_major_decision_sum %>% spread(decision, sum_dec)
View(data_eritrea_major_decision_rate)
data_eritrea_major_decision_rate <- data_eritrea_major_decision_sum %>% spread(decision, sum_dec)
data_eritrea_major_decision_rate <- transform(data_eritrea_major_decision_rate, rate=Rejected/Total)
major_countries_dest=c("Belgium","France","Germany (until 1990 former territory of the FRG)","Greece","Italy","Netherlands","Norway","Sweden","Spain","Switzerland","United Kingdom")
decision_acc=c("Rejected", "Total positive decisions", "Total")
data_eritrea_major_decision <- data_eritrea%>%filter(citizen=="Eritrea",geo%in%major_countries_dest,decision%in%decision_acc,age=="Total",sex=="Total",substr(time,1,4)=="2015")
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)%>%summarise(sum_dec=sum(values))
View(data_eritrea_major_decision)
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)%>%summarise(sum_dec=sum(values))
data_eritrea_major_decision_sum %<>% mutate(decision = ifelse(decision == "Total positive decisions",
"Total_positive_decisions",
decision))
data_eritrea_major_decision %<>% mutate(decision = ifelse(decision == "Total positive decisions",
"Total_positive_decisions",
decision))
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)%>%summarise(sum_dec=sum(values))
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,date,decision)%>%summarise(sum_dec=sum(values))
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,time,decision)%>%summarise(sum_dec=sum(values))
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,time,decision)
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,time,decision) %>% summarise(sum_decision=sum(values))
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision) %>% summarise(sum_decision=sum(values))
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,time,decision) %>% summarise_each(sum_decision=sum(values))
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision) %>% plyr::summarise(sum_decision=sum(values))
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)%>%summarise(sum_dec=sum(values))
data_eritrea_major_decision_sum
data_eritrea_major_decision
data_eritrea_major_decision <- subset(data_eritrea_major_decision, select=-c(sex,age))
data_eritrea_major_decision
View(data_eritrea_major_decision)
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)%>%summarise(sum_dec=sum(values))
View(data_eritrea_major_decision_sum)
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)
View(data_eritrea_major_decision_sum)
data_eritrea_major_decision_sum%<>%summarize(sum_val=sum(values))
View(data_eritrea_major_decision_sum)
data_eritrea_major_decision_sum%<>%summarize(sum_val=sum(values,na.rm=TRUE))
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)
data_eritrea_major_decision_sum%<>%summarize(sum_val=sum(values,na.rm=TRUE))
View(data_eritrea_major_decision_sum)
data_eritrea_major_decision_sum<-data_eritrea_major_decision%>%group_by(geo,decision)
View(data_eritrea_major_decision_sum)
data_eritrea_major_decision <- subset(data_eritrea_major_decision, select=-c(sex,age,unit)
)
data_eritrea_major_decision <- subset(data_eritrea_major_decision, select=-c(unit))
View(data_eritrea_major_decision)
write.table(data_eritrea_major_decision,file="data/eritrea_decision_major_eucountries_20170427.csv",sep=",",dec = " ")
data_acc
View(data_acc)
data_acc <- readRDS("/Users/suny/r-eurostat-refugees/data/data_acceptance")
View(data_acc)
data_eritrea <- data_acc %>% filter(citizen=="Eritrea")
ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
list.of.packages <- c("tidyr", "dplyr", "magrittr", "ggplot2", "eurostat", "gridExtra", "lubridate")
ipak(list.of.packages)
for(pkg in list.of.packages){
libary(pkg)
}
for(pkg in list.of.packages){
library(pkg)
}
for(p in list.of.packages){
library(p)
}
for(p in list.of.packages){
library("p")
}
lapply(list.of.packages, require, character.only = TRUE)
major_countries_dest=c("Belgium","France","Germany (until 1990 former territory of the FRG)","Greece","Italy","Netherlands","Norway","Sweden","Spain","Switzerland","United Kingdom")
decision_cum=c("Rejected", "Total positive decisions", "Total")
decision_acc_total=c("Total positive decisions", "Total")
decision_acc_total
decision_acc_total=c("Total positive decisions", "Total")
mutate(decision = ifelse(decision == "Total positive decisions",
"Total_positive_decisions",
decision))
decision_acc_total
library("eurostat");
saveAsylumEurostatRds <- function()
{
for (eCode in search_eurostat("asylum")$code)
{
message(sprintf("saving %s", eCode));
d <- get_eurostat(eCode, time_format="date");
saveRDS(d, file=sprintf("%s.rds", eCode));
}
}
loadAsylumEurostatRds <- function()
{
l <- list();
for (fname in dir(pattern=".*\\.rds"))
{
eCode <- substr(fname, 1, nchar(fname) - 4);
l[[eCode]] <- readRDS(fname);
}
return(l);
}
ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
list.of.packages <- c("tidyr", "dplyr", "magrittr", "ggplot2", "eurostat", "gridExtra", "lubridate")
ipak(list.of.packages)
lapply(list.of.packages, require, character.only = TRUE)
library(eurostatasyl)
data_acc_raw = readRDS('/home/suny/r-eurostat-refugees/data/migr_asyappctza.rds')
View(data_acc_raw)
acc_data = load_data_acceptance_file('/Users/suny/r-eurostat-refugees/data/data_acceptance')
acc_data = load_data_acceptance_file('/home/suny/r-eurostat-refugees/data/data_acceptance')
View(acc_data)
desc(acc_data)
acc_data = load_data_acceptance_file('/home/suny/r-eurostat-refugees/data/data_acceptance')
desc(acc_data)
acc_data = load_data_acceptance_file('/home/suny/r-eurostat-refugees/data/data_acceptance')
acc_data_api = load_data_acceptance_api()
Sys.date()
Sys.Date()
today=Sys.Date()
saveRDS('migr_asydcfstq_'today'.rds',acc_data_api)
saveRDS(paste('migr_asydcfstq_',today,'.rds'),acc_data_api)
paste("bla",today)
saveRDS(paste("migr_asydcfstq_",today,".rds", sep=""),acc_data_api)
paste("migr_asydcfstq_", today, ".rds", sep = "")
saveRDS(acc_data_api,file=paste("migr_asydcfstq_",today,".rds", sep=""))
View(acc_data_api)
desc(acc_data_api)
size(acc_data_api)
dim(acc_data_api)
data_acc_api_raw=get_eurostat("migr_asydcfstq", time_format = "date")
dim(data_acc_api_raw)
View(data_acc_api_raw)
data_acc_api_raw=get_eurostat("migr_asydcfstq", time_format = "date")
library(eurostat)
data_acc_api_raw=get_eurostat("migr_asydcfstq", time_format = "date")
decisions_firstinstance_annual=get_eurostat("migr_asydcfsta", time_format = "date")
summary(decisions_firstinstance_annual)
View(decisions_firstinstance_annual)
typeof(decisions_firstinstance_annual)
help("filter")
library(dplyr)
help("filter")
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex="TOTAL", citizen != "EXT_EU28", age ="TOTAL")
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "TOTAL", citizen != "EXT_EU28", age == "TOTAL")
dim(decfistinannual_cleaned)
View(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, citizen != "EXT_EU28")
dim(decfistinannual_cleaned)
dim(decisions_firstinstance_annual)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "TOTAL" & citizen != "EXT_EU28" & age == "TOTAL")
dim(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "TOTAL", age == "TOTAL")
dim(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == 'TOTAL')
dim(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == TOTAL)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == 'F')
dim(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "T", citizen != "EXT_EU28" & age == "T")
dim(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "T")
dim(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "T", age == "T")
dim(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "T")
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "T", age == "TOTAL")
dim(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "T", age == "TOTAL",  citizen != "EXT_EU28")
dim(decfistinannual_cleaned)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "T", age == "TOTAL",  citizen != "EXT_EU28", geo != "EU28")
dim(decfistinannual_cleaned)
unique(decfistinannual_cleaned$decision)
decfistinannual_cleaned <- filter(decisions_firstinstance_annual, sex == "T", age == "TOTAL",  citizen != "EXT_EU28", geo != "EU28", decision %in% c("TOTAL","TOTAL_POS"))
dim(decfistinannual_cleaned)
sum_per_citizen <- ddply(decfistinannual_cleaned, .(citizen), summarize, sum(values))
citval <- decfistinannual_cleaned[1,8]
View(citval)
citval <- decfistinannual_cleaned[,c(1,8)]
sum_per_citizen <- aggregate(x=decfistinannual_cleaned[,c(1,8)], by = "citizen", FUN = sum)
sum_per_citizen <- aggregate(x=decfistinannual_cleaned[,c(1,8)], by = c("citizen"), FUN = sum)
sum_per_citizen <- aggregate(x=decfistinannual_cleaned[,c(1,8)], by = decfistinannual_cleaned["citizen"], FUN = sum)
sum_per_citizen <- aggregate(x=citval, by = citval["citizen"], FUN = sum)
sum_per_citizen <- aggregate.data.frame(x=decfistinannual_cleaned[,c(1,8)], by = decfistinannual_cleaned["citizen"], FUN = sum)
sum_per_citizen <- aggregate.data.frame( by = decfistinannual_cleaned["citizen"], data = citval, FUN = sum)
sum_per_citizen <- aggregate.data.frame(x=citval, by = decfistinannual_cleaned["citizen"], data = citval, FUN = sum)
sum_per_citizen <- aggregate.data.frame(x=citval, by = decfistinannual_cleaned["citizen"], data = citval$values, FUN = sum)
sum_per_citizen <- aggregate.data.frame(x=citval, by = decfistinannual_cleaned["citizen"], data =  as.numeric(as.character(citval$values)), FUN = sum)
citval$values <-  as.numeric(as.character(citval$values))
sum_per_citizen <- aggregate(x=citval, by = citval["citizen"], FUN = sum)
citval
sum_per_citizen <- aggregate(x=citval, by = citval["citizen"], data = citval, FUN = sum)
decisions_firstinstance_annual
